"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[504],{2173:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/token-handler-api-flow-47984c0c8c501e89adaca58b9e5405af.svg"},2486:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/token-handler-architecture-bff85b83fb889950d1bdba27c635d278.svg"},876:(e,t,r)=>{r.d(t,{Zo:()=>l,kt:()=>f});var n=r(2784);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),p=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},l=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),u=p(r),d=a,f=u["".concat(s,".").concat(d)]||u[d]||h[d]||o;return r?n.createElement(f,i(i({ref:t},l),{},{components:r})):n.createElement(f,i({ref:t},l))}));function f(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=d;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c[u]="string"==typeof e?e:a,i[1]=c;for(var p=2;p<o;p++)i[p]=r[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},546:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>p});var n=r(7896),a=(r(2784),r(876));const o={sidebar_position:2},i="Authentication",c={unversionedId:"architecture/authentication",id:"architecture/authentication",title:"Authentication",description:"Token Handler Pattern",source:"@site/docs/architecture/authentication.md",sourceDirName:"architecture",slug:"/architecture/authentication",permalink:"/architecture/authentication",draft:!1,editUrl:"https://github.com/marleypowell/goalie/tree/main/apps/website/docs/architecture/authentication.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"docsSidebar",previous:{title:"Microservice Architecture",permalink:"/architecture/microservice-architecture"},next:{title:"Entity Relationship",permalink:"/architecture/entity-relationship"}},s={},p=[{value:"Token Handler Pattern",id:"token-handler-pattern",level:2},{value:"Token Handler Api Flow",id:"token-handler-api-flow",level:2}],l={toc:p},u="wrapper";function h(e){let{components:t,...o}=e;return(0,a.kt)(u,(0,n.Z)({},l,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"authentication"},"Authentication"),(0,a.kt)("h2",{id:"token-handler-pattern"},"Token Handler Pattern"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Token Handler Architecture",src:r(2486).Z,width:"618",height:"256"})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"source: ",(0,a.kt)("a",{parentName:"p",href:"https://curity.io/resources/learn/token-handler-spa-example/"},"https://curity.io/resources/learn/token-handler-spa-example/"))),(0,a.kt)("p",null,"The Token Handler Pattern is a pattern that is used to provide a single point of authentication for a browser-based application. The Token Handler Pattern was used for the application as it is considered a best practice for browser-based applications as documented in ",(0,a.kt)("a",{parentName:"p",href:"https://datatracker.ietf.org/doc/html/draft-ietf-oauth-browser-based-apps"},"OAuth 2.0 for Browser-Based Apps"),"."),(0,a.kt)("p",null,"From the diagram the SPA refers to the ",(0,a.kt)("a",{parentName:"p",href:"../project-structure/apps/frontend"},"Frontend")," application. The Token Handler refers to the ",(0,a.kt)("a",{parentName:"p",href:"../project-structure/services/oauth-agent-service"},"OAuth Agent Service"),". The JWT protected APIs refer to the ",(0,a.kt)("a",{parentName:"p",href:"../project-structure/services/api-gateway"},"API Gateway"),". The Authorization Server refers to the ",(0,a.kt)("a",{parentName:"p",href:"../project-structure/services/curity-identity-server"},"Curity Identity Server"),"."),(0,a.kt)("p",null,"Further documentation around the OAuth Agent in this diagram can be found ",(0,a.kt)("a",{parentName:"p",href:"../project-structure/services/oauth-agent-service"},"here"),"."),(0,a.kt)("h2",{id:"token-handler-api-flow"},"Token Handler Api Flow"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Token Handler Api Flow",src:r(2173).Z,width:"1063",height:"561"})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"source: ",(0,a.kt)("a",{parentName:"p",href:"https://curity.io/resources/learn/token-handler-deployment-example/"},"https://curity.io/resources/learn/token-handler-deployment-example/"))),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"The SPA makes a request through the reverse proxy. In the application the reverse proxy is the ",(0,a.kt)("a",{parentName:"li",href:"../architecture/technologies/nginx-ingress-controller"},"Nginx Ingress Controller")," service."),(0,a.kt)("li",{parentName:"ol"},"The OAuth Proxy Plugin is used to authenticate the user. It does this by decrypting the received auth cookie and extracting an Opaque access token from it. The Opaque access token is then sent to the Phantom Token plugin."),(0,a.kt)("li",{parentName:"ol"},"The Phantom Token plugin is used to exchange the Opaque access token for a JWT token with the ",(0,a.kt)("a",{parentName:"li",href:"../project-structure/services/curity-identity-server"},"Curity Identity Server"),". This is known as ",(0,a.kt)("a",{parentName:"li",href:"https://oauth.net/2/token-introspection"},"token introspection"),". The JWT token is then sent as a request authentication header."),(0,a.kt)("li",{parentName:"ol"},"The receiving service validates the JWT token and extracts the user's profile information from the token. The user's profile information is then used to authorize the user.")))}h.isMDXComponent=!0}}]);